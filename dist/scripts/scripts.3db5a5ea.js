"use strict";console.log("definisco la mia applicazione angular"),angular.module("makerWeekApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","rzModule","uiGmapgoogle-maps"]).config(["uiGmapGoogleMapApiProvider",function(a){a.configure({key:"AIzaSyBeSx-ctB2GTusftGsEZLXaaTrYLfwKfOU",v:"3.20",libraries:"weather,geometry,visualization"})}]).config(["$routeProvider",function(a){console.log("configuro il $routerProvider"),a.when("/",{templateUrl:"views/map.html",controller:"MapCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("makerWeekApp").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("makerWeekApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("makerWeekApp").controller("MapCtrl",["$scope","poiApi",function(a,b){function c(){a.loading=!0,b.score(a.servizi.value,a.ambiente.value,a.cultura.value,a.salute.value).then(function(b){a.scores=b,a.currentScore=a.scores[1].scorePercentage,a.currentName=a.names[1]})["catch"](function(a){console.error(a)})["finally"](function(){a.loading=!1})}this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.loading=!1,a.getScore=function(b){return a.scores[b].scorePercentage},a.ambiente={value:1,options:{floor:0,ceil:10,onChange:c}},a.cultura={value:1,options:{floor:0,ceil:10,onChange:c}},a.salute={value:1,options:{floor:0,ceil:10,onChange:c}},a.servizi={value:1,options:{floor:0,ceil:10,onChange:c}},a.currentScore=void 0,a.scores=[],a.currentName="",a.names={1:"Picone-Poggiofranco-Carrassi-San Pasquale-Mungivacca",3:"Palese-S.Spirito-Catino-San Pio",4:"San Paolo-Stanic-Villaggio del Lavoratore-San Girolamo-Fesca-Marconi",5:"Carbonara-Ceglie-Loseto"},a.isTheWinner=function(b){var c=_.values(a.scores),d=_.maxBy(c,"scorePercentage").scorePercentage;return d===a.scores[b].scorePercentage},a.map={center:{latitude:41.16,longitude:16.8},zoom:11},b.getMunicipi().success(function(b){a.polygons=_(b.results).filter(function(a){return 2!=a.properties.OBJECTID}).map(function(a){return{id:a.properties.OBJECTID,path:_.map(a.geometry.coordinates[0],function(a){return{latitude:a[1],longitude:a[0]}}),stroke:{color:"#6060FB",weight:1},geodesic:!1,visible:!0}}).value(),a.polygons[0].events={mouseover:function(){a.currentScore=a.scores[1].scorePercentage,a.currentName=a.names[1]}},a.polygons[0].fill={municipio:1,color:"#00ff00",opacity:.8},a.polygons[1].events={mouseover:function(){a.currentScore=a.scores[5].scorePercentage,a.currentName=a.names[5]}},a.polygons[1].fill={municipio:5,color:"#ff0000",opacity:.8},a.polygons[2].events={mouseover:function(){a.currentScore=a.scores[3].scorePercentage,a.currentName=a.names[3]}},a.polygons[2].fill={municipio:3,color:"#00ffff",opacity:.8},a.polygons[3].events={mouseover:function(){a.currentScore=a.scores[4].scorePercentage,a.currentName=a.names[4]}},a.polygons[3].fill={municipio:4,color:"#ffff00",opacity:.8},a.polygonsMun3=_(b.results[2].geometry.coordinates).map(function(a){return{path:_.map(a[0],function(a){return{latitude:a[1],longitude:a[0]}}),fill:{color:"#0000ff"},stroke:{color:"#6060FB",weight:1},geodesic:!1,visible:!0}}).value()}),c()}]),angular.module("makerWeekApp").service("poiApi",["$http","$q",function(a,b){this.getMunicipi=function(){return a.get("http://146.185.165.167:9100/odlab/v1/municipi")},this.score=function(c,d,e,f){function g(a){return"http://146.185.165.167:9100/odlab/v1/score/"+a+"/"+c+"/"+d+"/"+e+"/"+f}var h=b.defer();return async.parallel([function(b){a.get(g(1)).then(function(a){b(null,{municipio:1,score:a.data})})["catch"](function(a){b(a)})},function(b){a.get(g(3)).then(function(a){b(null,{municipio:3,score:a.data})})["catch"](function(a){b(a)})},function(b){a.get(g(4)).then(function(a){b(null,{municipio:4,score:a.data})})["catch"](function(a){b(a)})},function(b){a.get(g(5)).then(function(a){b(null,{municipio:5,score:a.data})})["catch"](function(a){b(a)})}],function(a,b){if(a)h.reject(a);else{var c=_.reduce(b,function(a,b){return a+parseInt(b.score)},0),d={};_.forEach(b,function(a){d[a.municipio]={score:a.score,scorePercentage:a.score/c*100}}),h.resolve(d)}}),h.promise}}]),angular.module("makerWeekApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<div class="jumbotron"> <h1>\'Allo, \'Allo!</h1> <p class="lead"> <img src="images/yeoman.8cb970fb.png" alt="I\'m Yeoman"><br> Always a pleasure scaffolding your apps. </p> <p><a class="btn btn-lg btn-success" ng-href="#/">Splendid!<span class="glyphicon glyphicon-ok"></span></a></p> </div> <div class="row marketing"> <h4>HTML5 Boilerplate</h4> <p> HTML5 Boilerplate is a professional front-end template for building fast, robust, and adaptable web apps or sites. </p> <h4>Angular</h4> <p> AngularJS is a toolset for building the framework most suited to your application development. </p> <h4>Karma</h4> <p>Spectacular Test Runner for JavaScript.</p> </div>'),a.put("views/map.html",'<div class="row"> <div class="col-lg-6"> <br> <p><i>Cosa deve avere il tuo quartiere ideale? Dai un punteggio da 1 a 10 a ciascun indicatore e scopri la percentuale di qualit√† del tuo quartiere.</i></p> <hr> <h4>Verde nel tuo quartiere</h4> <rzslider rz-slider-model="ambiente.value" rz-slider-options="ambiente.options"></rzslider> <h4>Cultura nel tuo quartiere</h4> <rzslider rz-slider-model="cultura.value" rz-slider-options="cultura.options"></rzslider> <h4>Salute nel tuo quartiere</h4> <rzslider rz-slider-model="salute.value" rz-slider-options="salute.options"></rzslider> <h4>Servizi al cittadino nel tuo quartiere</h4> <rzslider rz-slider-model="servizi.value" rz-slider-options="servizi.options"></rzslider> <p></p> <div style="text-align: center" ng-if="loading"> <img src="/images/ajax-loader.a086e5b9.gif" alt=""> </div> <table class="table table-condensed" ng-if="!loading"> <thead> <tr> <th>Municipio</th> <th>Punteggio</th> </tr> </thead> <tbody> <tr ng-repeat="(key, value) in names" ng-class="{success:isTheWinner(key)}"> <td>{{value}}</td> <td>{{getScore(key) | number:2}}%</td> </tr> </tbody> </table> <!--<div class="row" ng-if="!loading">--> <!--<div class="col-md-8">--> <!--{{currentName}}--> <!--</div>--> <!--<h3 class="col-md-4">--> <!--{{currentScore | number:2}}<span ng-if="currentScore">%</span>--> <!--</h3>--> <!--</div>--> </div> <div class="col-lg-6"> <ui-gmap-google-map center="map.center" zoom="map.zoom"> <ui-gmap-polygon static="true" ng-repeat="p in polygonsMun3 track by $index" path="p.path" stroke="p.stroke" visible geodesic="p.geodesic" fill="p.fill" fit="false" clickable="true" editable="p.editable" draggable> </ui-gmap-polygon> <ui-gmap-polygon static="true" ng-repeat="p in polygons track by p.id" path="p.path" stroke="p.stroke" visible geodesic="p.geodesic" fill="p.fill" fit="false" events="p.events" clickable="true" editable="p.editable" draggable> </ui-gmap-polygon> </ui-gmap-google-map> </div> </div>')}]);